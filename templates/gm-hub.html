<div class="rnk-illumination-content">
  <!-- GM Card -->
  <div class="rnk-illumination-gm-section">
    <div class="rnk-illumination-gm-card">
      <div class="rnk-illumination-avatar-container">
        <img class="rnk-illumination-avatar" src="{{gm.avatar}}" alt="{{gm.name}}" style="border-color: {{gmSettings.color}}" onerror="this.src='icons/svg/mystery-man.svg'">
        <button type="button" class="rnk-avatar-upload-btn" data-user="{{gm.id}}" title="Upload Avatar">ðŸ“·</button>
      </div>
      <div class="rnk-illumination-gm-info">
        <span class="rnk-illumination-name">{{gm.name}}</span>
        <span class="rnk-illumination-role">Game Master</span>
      </div>
      <input type="color" name="gmColor" value="{{gmSettings.color}}" title="Illumination Color">
      <select name="gmEffect" title="Effect Style">
        {{#each effects}}
        <option value="{{this}}" {{#if (eq this ../gmSettings.effect)}}selected{{/if}}>{{#if (eq this 'none')}}None (Disabled){{else}}{{this}}{{/if}}</option>
        {{/each}}
      </select>
      <select name="gmSymbol" title="Target Symbol">
        {{#each symbols}}
        <option value="{{this}}" {{#if (eq this ../gmSettings.symbol)}}selected{{/if}}>{{this}}</option>
        {{/each}}
      </select>
      <div class="rnk-illumination-custom">
        <input type="text" name="gmCustomSymbol" value="{{gmSettings.customSymbol}}" placeholder="Image URL or path">
        <button type="button" class="rnk-upload-btn" data-target="gmCustomSymbol">Upload</button>
      </div>
      <input type="number" name="gmIntensity" value="{{gmSettings.intensity}}" min="0.1" max="3.0" step="0.1" title="Effect Intensity">
      <select name="gmRange" title="Effect Range">
        {{#each ranges}}
        <option value="{{this}}" {{#if (eq this ../gmSettings.range)}}selected{{/if}}>Range: {{this}}px</option>
        {{/each}}
      </select>
    </div>
  </div>

  <!-- Other Users Section -->
  {{#if users.length}}
  <div class="rnk-illumination-divider">RNKâ„¢ Authorized Users</div>

  <div class="rnk-illumination-grid">
    {{#each users}}
    <div class="rnk-illumination-player-card">
      <div class="rnk-illumination-avatar-container">
        <img class="rnk-illumination-avatar" src="{{this.avatar}}" alt="{{this.name}}" style="border-color: {{this.settings.color}}" onerror="this.src='icons/svg/mystery-man.svg'">
        <button type="button" class="rnk-avatar-upload-btn" data-user="{{this.id}}" title="Upload Avatar">ðŸ“·</button>
      </div>
      <span class="rnk-illumination-name">{{this.name}}</span>
      <input type="color" name="{{this.id}}_color" value="{{this.settings.color}}" title="Illumination Color">
      <select name="{{this.id}}_effect" title="Effect Style">
        {{#each ../effects}}
        <option value="{{this}}" {{#if (eq this ../this.settings.effect)}}selected{{/if}}>{{#if (eq this 'none')}}None (Disabled){{else}}{{this}}{{/if}}</option>
        {{/each}}
      </select>
      <select name="{{this.id}}_symbol" title="Target Symbol">
        {{#each ../symbols}}
        <option value="{{this}}" {{#if (eq this ../this.settings.symbol)}}selected{{/if}}>{{this}}</option>
        {{/each}}
      </select>
      <div class="rnk-illumination-custom">
        <input type="text" name="{{this.id}}_customSymbol" value="{{this.settings.customSymbol}}" placeholder="Image URL or path">
        <button type="button" class="rnk-upload-btn" data-target="{{this.id}}_customSymbol">Upload</button>
      </div>
      <input type="number" name="{{this.id}}_intensity" value="{{this.settings.intensity}}" min="0.1" max="3.0" step="0.1" title="Effect Intensity">
      <select name="{{this.id}}_range" title="Effect Range">
        {{#each ../ranges}}
        <option value="{{this}}" {{#if (eq this ../this.settings.range)}}selected{{/if}}>Range: {{this}}px</option>
        {{/each}}
      </select>
    </div>
    {{/each}}
  </div>
  {{else}}
  <div class="rnk-illumination-empty">No other users connected</div>
  {{/if}}

  <button type="submit" class="rnk-illumination-save">Save All Settings</button>
</div>
